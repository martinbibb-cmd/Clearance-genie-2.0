(function(){
    // Simple loader that fetches the Three.js CDN build when available.
    if (window.__threeReadyPromise) return;

    if (window.THREE) {
        window.__threeReadyPromise = Promise.resolve(window.THREE);
        return;
    }

    window.__threeReadyPromise = new Promise(function(resolve, reject) {
        var script = document.createElement('script');
        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js';
        script.async = true;
        script.onload = function() { resolve(window.THREE); };
        script.onerror = function(err) {
            console.error('[Three Loader] Failed to load Three.js from CDN', err);
            reject(err);
        };
        document.head.appendChild(script);
    });
})();
